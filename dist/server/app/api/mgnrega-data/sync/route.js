(()=>{var e={};e.id=6,e.ids=[6],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},28855:e=>{"use strict";e.exports=import("@libsql/client")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41024:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{patchFetch:()=>c,routeModule:()=>l,serverHooks:()=>m,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>p});var n=r(96559),o=r(48088),i=r(37719),d=r(96846),s=e([d]);d=(s.then?(await s)():s)[0];let l=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/mgnrega-data/sync/route",pathname:"/api/mgnrega-data/sync",filename:"route",bundlePath:"app/api/mgnrega-data/sync/route"},resolvedPagePath:"C:\\Users\\deshm\\Downloads\\mgnrega-district-dashboard-main\\mgnrega-district-dashboard-main\\src\\app\\api\\mgnrega-data\\sync\\route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:u,workUnitAsyncStorage:p,serverHooks:m}=l;function c(){return(0,i.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:p})}a()}catch(e){a(e)}})},42154:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{db:()=>c});var n=r(65817),o=r(28855),i=r(57671),d=e([o,n]);[o,n]=d.then?(await d)():d;let s=(0,o.createClient)({url:process.env.TURSO_CONNECTION_URL,authToken:process.env.TURSO_AUTH_TOKEN}),c=(0,n.f)(s,{schema:i});a()}catch(e){a(e)}})},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57671:(e,t,r)=>{"use strict";r.r(t),r.d(t,{categoryBreakdown:()=>c,districtPerformance:()=>d,districts:()=>i,monthlyTrends:()=>s});var a=r(28234),n=r(70932),o=r(89283);let i=(0,a.D)("districts",{id:(0,n.nd)("id").primaryKey({autoIncrement:!0}),districtCode:(0,o.Qq)("district_code").notNull().unique(),districtNameEn:(0,o.Qq)("district_name_en").notNull(),districtNameHi:(0,o.Qq)("district_name_hi").notNull(),stateName:(0,o.Qq)("state_name").notNull(),createdAt:(0,o.Qq)("created_at").notNull(),updatedAt:(0,o.Qq)("updated_at").notNull()}),d=(0,a.D)("district_performance",{id:(0,n.nd)("id").primaryKey({autoIncrement:!0}),districtId:(0,n.nd)("district_id").notNull().references(()=>i.id),dataDate:(0,o.Qq)("data_date").notNull(),workCompleted:(0,n.nd)("work_completed").notNull(),fundsUtilizedPercentage:(0,n.nd)("funds_utilized_percentage").notNull(),activeWorkers:(0,n.nd)("active_workers").notNull(),averageWage:(0,n.nd)("average_wage").notNull(),workCompletionRate:(0,n.nd)("work_completion_rate").notNull(),fundUtilizationRate:(0,n.nd)("fund_utilization_rate").notNull(),workerParticipationRate:(0,n.nd)("worker_participation_rate").notNull(),targetWorks:(0,n.nd)("target_works").notNull(),achievementWorks:(0,n.nd)("achievement_works").notNull(),createdAt:(0,o.Qq)("created_at").notNull(),updatedAt:(0,o.Qq)("updated_at").notNull()}),s=(0,a.D)("monthly_trends",{id:(0,n.nd)("id").primaryKey({autoIncrement:!0}),districtId:(0,n.nd)("district_id").notNull().references(()=>i.id),month:(0,n.nd)("month").notNull(),year:(0,n.nd)("year").notNull(),workCompleted:(0,n.nd)("work_completed").notNull(),fundsUtilized:(0,n.nd)("funds_utilized").notNull(),activeWorkers:(0,n.nd)("active_workers").notNull(),createdAt:(0,o.Qq)("created_at").notNull()}),c=(0,a.D)("category_breakdown",{id:(0,n.nd)("id").primaryKey({autoIncrement:!0}),districtId:(0,n.nd)("district_id").notNull().references(()=>i.id),dataDate:(0,o.Qq)("data_date").notNull(),categoryName:(0,o.Qq)("category_name").notNull(),percentage:(0,n.nd)("percentage").notNull(),workCount:(0,n.nd)("work_count").notNull(),createdAt:(0,o.Qq)("created_at").notNull()})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{},96846:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{POST:()=>c});var n=r(32190),o=r(42154),i=r(57671),d=r(94634),s=e([o]);async function c(e){try{let{districtCode:t,performance:r,monthlyTrends:a,categoryBreakdown:s}=await e.json();if(!t)return n.NextResponse.json({error:"District code is required",code:"MISSING_DISTRICT_CODE"},{status:400});if(!r)return n.NextResponse.json({error:"Performance data is required",code:"MISSING_PERFORMANCE_DATA"},{status:400});for(let e of["dataDate","workCompleted","fundsUtilizedPercentage","activeWorkers","averageWage","workCompletionRate","fundUtilizationRate","workerParticipationRate","targetWorks","achievementWorks"])if(void 0===r[e]||null===r[e])return n.NextResponse.json({error:`Performance field '${e}' is required`,code:"MISSING_REQUIRED_FIELD"},{status:400});let c=await o.db.select().from(i.districts).where((0,d.eq)(i.districts.districtCode,t)).limit(1);if(0===c.length)return n.NextResponse.json({error:"District not found",code:"DISTRICT_NOT_FOUND"},{status:404});let l=c[0].id,u=new Date().toISOString(),p=(await o.db.insert(i.districtPerformance).values({districtId:l,dataDate:r.dataDate,workCompleted:r.workCompleted,fundsUtilizedPercentage:r.fundsUtilizedPercentage,activeWorkers:r.activeWorkers,averageWage:r.averageWage,workCompletionRate:r.workCompletionRate,fundUtilizationRate:r.fundUtilizationRate,workerParticipationRate:r.workerParticipationRate,targetWorks:r.targetWorks,achievementWorks:r.achievementWorks,createdAt:u,updatedAt:u}).returning())[0].id,m=[];if(a&&Array.isArray(a)&&a.length>0)for(let e of a){if(!e.month||!e.year||void 0===e.workCompleted||void 0===e.fundsUtilized||void 0===e.activeWorkers)continue;let t=await o.db.insert(i.monthlyTrends).values({districtId:l,month:e.month,year:e.year,workCompleted:e.workCompleted,fundsUtilized:e.fundsUtilized,activeWorkers:e.activeWorkers,createdAt:u}).returning();m.push(t[0].id)}let g=[];if(s&&Array.isArray(s)&&s.length>0)for(let e of s){if(!e.categoryName||void 0===e.percentage||void 0===e.workCount)continue;let t=await o.db.insert(i.categoryBreakdown).values({districtId:l,dataDate:r.dataDate,categoryName:e.categoryName,percentage:e.percentage,workCount:e.workCount,createdAt:u}).returning();g.push(t[0].id)}return n.NextResponse.json({message:"MGNREGA data synced successfully",data:{performanceId:p,trendIds:m,categoryIds:g,districtId:l,districtCode:t}},{status:201})}catch(e){return console.error("POST error:",e),n.NextResponse.json({error:"Internal server error: "+e.message},{status:500})}}o=(s.then?(await s)():s)[0],a()}catch(e){a(e)}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,580,817],()=>r(41024));module.exports=a})();